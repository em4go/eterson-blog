---
import type {CollectionEntry} from 'astro:content';
import Layout from './Layout.astro';
import Header from '../components/Header.astro';
import FormattedDate from '../components/FormattedDate.astro';
import {Image} from 'astro:assets';

type DataProps = CollectionEntry<'blog'>['data'];

const {
	title,
	description,
	pubDate,
	updatedDate,
	heroImage,
	prevHref,
	nextHref,
	readTime,
} = Astro.props as DataProps & {
	prevHref?: string | null;
	nextHref?: string | null;
	readTime?: string;
};
---

<Layout
	title={title}
	description={description}
	ogType='article'
	publishedTime={pubDate}
	modifiedTime={updatedDate}
	image={heroImage}
>
	<!-- Top nav area consistent with home -->
	<div class='w-full bg-gray-900 px-4 sm:px-6 md:px-8'>
		<div class='max-w-7xl mx-auto'>
			<Header />
		</div>
	</div>

	<main class='w-full'>
		<article class='max-w-5xl mx-auto bg-gray-900 px-4 sm:px-6 md:px-8'>
			<!-- Title + meta -->
			<header class='pt-10 sm:pt-12 md:pt-16'>
				<p
					class='text-xs sm:text-sm tracking-widest text-emerald-300/90 uppercase'
				>
					<FormattedDate date={pubDate} />
					{
						updatedDate && (
							<span class='ml-2 opacity-80'>
								• updated <FormattedDate date={updatedDate} />
							</span>
						)
					}
					{readTime && <span class='ml-2'>• {readTime}</span>}
				</p>
				<h1
					class='mt-3 sm:mt-4 font-space-grotesk font-black uppercase tracking-tight leading-[0.95] text-5xl sm:text-6xl md:text-7xl text-cyan-50'
				>
					{title}
				</h1>
				<div
					class='mt-5 h-1 w-full bg-gradient-to-r from-cyan-400 to-transparent'
				>
				</div>
			</header>

			{
				heroImage && (
					<div class='mt-8'>
						<Image
							width={1280}
							height={640}
							src={heroImage}
							alt=''
							class='w-full rounded-sm shadow-[8px_8px_0_0_rgba(34,211,238,0.25)] ring-1 ring-cyan-400/30'
						/>
					</div>
				)
			}

			<div class='post-content mt-10 sm:mt-12 text-cyan-100'>
				<slot />
			</div>

			<nav
				class='mt-12 sm:mt-16 grid grid-cols-3 items-center text-xs sm:text-sm uppercase tracking-widest'
			>
				<div class='justify-self-start'>
					{
						prevHref && (
							<a
								href={prevHref}
								class='text-cyan-300 hover:text-cyan-200 underline decoration-dotted underline-offset-4'
							>
								← Previous Post
							</a>
						)
					}
				</div>
				<div class='justify-self-center'>
					<a
						href='/blog'
						class='text-cyan-300 hover:text-cyan-200 underline decoration-dotted underline-offset-4'
					>
						Back to blog
					</a>
				</div>
				<div class='justify-self-end'>
					{
						nextHref && (
							<a
								href={nextHref}
								class='text-cyan-300 hover:text-cyan-200 underline decoration-dotted underline-offset-4'
							>
								Next Post →
							</a>
						)
					}
				</div>
			</nav>
			<div
				class='my-10 h-[1px] w-full bg-gradient-to-r from-transparent via-cyan-400/30 to-transparent'
			>
			</div>
		</article>
	</main>

	<style is:global>
		/* Post typography styling to match the site's dark aesthetic */
		.post-content {
			display: block;
		}
		.post-content h1,
		.post-content h2,
		.post-content h3,
		.post-content h4,
		.post-content h5,
		.post-content h6 {
			color: #e6ffff;
			text-transform: uppercase;
			letter-spacing: -0.01em;
			line-height: 1.1;
			margin: 2.25rem 0 0.75rem;
			font-family: 'Space Grotesk', sans-serif;
			font-weight: 800;
		}
		/* Proportional scale based on paragraph size */
		.post-content h1 {
			font-size: calc(var(--p-size) * 2.5);
		}
		.post-content h2 {
			font-size: calc(var(--p-size) * 2);
		}
		.post-content h3 {
			font-size: calc(var(--p-size) * 1.6);
		}
		.post-content h4 {
			font-size: calc(var(--p-size) * 1.35);
		}
		.post-content h5 {
			font-size: calc(var(--p-size) * 1.2);
		}
		.post-content h6 {
			font-size: calc(var(--p-size) * 1.1);
		}

		.post-content p,
		.post-content li {
			color: #cffafe;
			margin: 0.85rem 0;
			font-size: var(--p-size);
			line-height: var(--p-leading);
		}

		.post-content a {
			color: #67e8f9;
			text-decoration: underline;
			text-decoration-style: dotted;
			text-underline-offset: 4px;
		}
		.post-content a:hover {
			color: #a5f3fc;
		}

		.post-content hr {
			border: 0;
			height: 2px;
			margin: 2rem 0;
			background: linear-gradient(
				90deg,
				rgba(34, 211, 238, 0.6),
				rgba(34, 211, 238, 0)
			);
		}

		/* Code blocks */
		.post-content pre {
			background: #0f172a; /* slate-900 */
			color: #e2e8f0; /* slate-200 */
			border-left: 6px solid #22d3ee; /* cyan-400 */
			border-radius: 0;
			padding: 1rem 1.25rem;
			overflow: auto;
			box-shadow: 0 0 0 1px rgba(34, 211, 238, 0.15) inset;
			margin: 1.25rem 0;
			font-family: 'IBM Plex Mono', monospace;
			font-size: 0.95rem;
		}
		.post-content code {
			font-family: 'IBM Plex Mono', monospace;
			background: rgba(2, 132, 199, 0.12); /* sky-600/12 */
			color: #e0f2fe;
			padding: 0.15rem 0.35rem;
			border-radius: 2px;
		}
		.post-content pre code {
			background: transparent;
			padding: 0;
		}

		/* Blockquotes */
		.post-content blockquote {
			margin: 1.5rem 0;
			padding: 0.75rem 1rem;
			border-left: 6px solid #a78bfa; /* purple-400 */
			background: rgba(167, 139, 250, 0.07);
			color: #e9d5ff; /* purple-200 */
			font-style: italic;
		}

		.post-content ul {
			list-style: disc;
			padding-left: 1.25rem;
		}
		.post-content ol {
			list-style: decimal;
			padding-left: 1.25rem;
		}

		.post-content img {
			border-radius: 2px;
			box-shadow: 8px 8px 0 0 rgba(124, 58, 237, 0.35);
		}
	</style>
</Layout>
